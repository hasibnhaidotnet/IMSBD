@* @model IEnumerable<Inventorymanagementsystem.ViewModel.ProductStockViewModel> *@
@* @{ *@
@*     ViewData["Title"] = "Stock Report"; *@
@*     var categories = ViewBag.Categories as List<Inventorymanagementsystem.Models.Category>; *@
@*     var subCategories = ViewBag.SubCategories as List<Inventorymanagementsystem.Models.SubCategory>; *@

@*     int? selectedCategoryId = ViewBag.SelectedCategoryId; *@
@*     int? selectedSubCategoryId = ViewBag.SelectedSubCategoryId; *@
@*     bool lowStockOnly = ViewBag.LowStockOnly; *@
@*     int currentPage = ViewBag.CurrentPage; *@
@*     int totalPages = ViewBag.TotalPages; *@
@* } *@

@* <h2 class="mb-4">📦 Stock Report</h2> *@

@* <form method="get" class="row g-3 mb-4"> *@
@*     <div class="col-md-3"> *@
@*         <label>Category</label> *@
@*         <select name="categoryId" class="form-select"> *@
@*             <option value="">-- All Categories --</option> *@
@*             @foreach (var category in categories) *@
@*             { *@
@*                 if (selectedCategoryId == category.Id) *@
@*                 { *@
@*                     <option value="@category.Id" selected>@category.Name</option> *@
@*                 } *@
@*                 else *@
@*                 { *@
@*                     <option value="@category.Id">@category.Name</option> *@
@*                 } *@
@*             } *@
@*         </select> *@
@*     </div> *@

@*     <div class="col-md-3"> *@
@*         <label>SubCategory</label> *@
@*         <select name="subCategoryId" class="form-select"> *@
@*             <option value="">-- All SubCategories --</option> *@
@*             @foreach (var sub in subCategories) *@
@*             { *@
@*                 if (selectedSubCategoryId == sub.Id) *@
@*                 { *@
@*                     <option value="@sub.Id" selected>@sub.Name</option> *@
@*                 } *@
@*                 else *@
@*                 { *@
@*                     <option value="@sub.Id">@sub.Name</option> *@
@*                 } *@
@*             } *@
@*         </select> *@
@*     </div> *@

@*     <div class="col-md-2 d-flex align-items-end"> *@
@*         <div class="form-check"> *@
@*             <input class="form-check-input" type="checkbox" name="lowStockOnly" value="true" @(lowStockOnly ? "checked" : "") /> *@
@*             <label class="form-check-label">Low Stock Only</label> *@
@*         </div> *@
@*     </div> *@

@*     <div class="col-md-2 d-flex align-items-end"> *@
@*         <button type="submit" class="btn btn-primary w-100">🔍 Filter</button> *@
@*     </div> *@

@*     <div class="col-md-2 d-flex align-items-end"> *@
@*         <a href="@Url.Action("StockReport", "Reports")" class="btn btn-secondary w-100">🔄 Reset</a> *@
@*     </div> *@

@*     <div class="col-md-3 mt-3"> *@
@*         <a asp-action="ExportToExcel" asp-route-categoryId="@selectedCategoryId" asp-route-subCategoryId="@selectedSubCategoryId" asp-route-lowStockOnly="@lowStockOnly" class="btn btn-success"> *@
@*             📥 Export to Excel *@
@*         </a> *@

@*         <a asp-action="ExportToPdf" asp-route-categoryId="@selectedCategoryId" asp-route-subCategoryId="@selectedSubCategoryId" asp-route-lowStockOnly="@lowStockOnly" class="btn btn-danger ms-2"> *@
@*             📄 Export to PDF *@
@*         </a> *@
@*     </div> *@
@* </form> *@

@* <table class="table table-bordered table-striped"> *@
@*     <thead class="table-dark"> *@
@*         <tr> *@
@*             <th>Product</th> *@
@*             <th>Category</th> *@
@*             <th>SubCategory</th> *@
@*             <th>Purchased</th> *@
@*             <th>Purchase Return</th> *@
@*             <th>Sold</th> *@
@*             <th>Sales Return</th> *@
@*             <th>Damaged</th> *@
@*             <th>Current Stock</th> *@
@*         </tr> *@
@*     </thead> *@
@*     <tbody> *@
@*         @if (!Model.Any()) *@
@*         { *@
@*             <tr><td colspan="9" class="text-center">No data available</td></tr> *@
@*         } *@
@*         else *@
@*         { *@
@*             foreach (var item in Model) *@
@*             { *@
@*                 <tr class="@(item.CurrentStock <= 5 ? "table-danger" : "")"> *@
@*                     <td>@item.ProductName</td> *@
@*                     <td>@item.CategoryName</td> *@
@*                     <td>@item.SubCategoryName</td> *@
@*                     <td>@item.TotalPurchased</td> *@
@*                     <td>@item.TotalReturnedFromPurchase</td> *@
@*                     <td>@item.TotalSold</td> *@
@*                     <td>@item.TotalReturnedFromSale</td> *@
@*                     <td>@item.TotalDamaged</td> *@
@*                     <td><strong>@item.CurrentStock</strong></td> *@
@*                 </tr> *@
@*             } *@
@*         } *@
@*     </tbody> *@
@* </table> *@

@* <nav> *@
@*     <ul class="pagination justify-content-center"> *@
@*         <li class="page-item @(currentPage == 1 ? "disabled" : "")"> *@
@*             <a class="page-link" href="@Url.Action("StockReport", new { categoryId = selectedCategoryId, subCategoryId = selectedSubCategoryId, lowStockOnly = lowStockOnly, page = currentPage - 1 })">Previous</a> *@
@*         </li> *@

@*         @for (int i = 1; i <= totalPages; i++) *@
@*         { *@
@*             if (i == currentPage) *@
@*             { *@
@*                 <li class="page-item active"> *@
@*                     <span class="page-link">@i</span> *@
@*                 </li> *@
@*             } *@
@*             else *@
@*             { *@
@*                 <li class="page-item"> *@
@*                     <a class="page-link" href="@Url.Action("StockReport", new { categoryId = selectedCategoryId, subCategoryId = selectedSubCategoryId, lowStockOnly = lowStockOnly, page = i })">@i</a> *@
@*                 </li> *@
@*             } *@
@*         } *@

@*         <li class="page-item @(currentPage == totalPages ? "disabled" : "")"> *@
@*             <a class="page-link" href="@Url.Action("StockReport", new { categoryId = selectedCategoryId, subCategoryId = selectedSubCategoryId, lowStockOnly = lowStockOnly, page = currentPage + 1 })">Next</a> *@
@*         </li> *@
@*     </ul> *@
@* </nav> *@
